<!DOCTYPE html>
<html>
    <head>
        <title>Initiative tracker</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link  rel="stylesheet" href="./purecss/pure-min.css"/> 
        <link  rel="stylesheet" href="./fontello/css/fontello.css"/> 
        <style>
            .npc-list article {
                margin: 0.5em 0.5em 0;
            }
            .npc-list form {
                margin: 0 0.5em 1em;
            }
            .parry {
                text-align: center;
                background-color: lightblue;
            }
            .toughness {
                text-align: center;
                background-color: orange;
            }
            .ranged {
                text-align: center;
                background-color: lightgreen;
            }
            h1 {
                font-size: 120%;
                font-weight: lighter;
                margin: 0 0 0.3em;
            }
            input[type=radio] {
                margin-left: 0.8em;
            }
        </style>        
    </head>
    <body>
        <div x-data="model" class="npc-list">
            <template x-for="(npc, idx) in encounter">
                <div class="pure-g">
                    <div class="pure-u-5-8">
                        <article>
                            <h1><span x-text="npc.name"></span><i class="icon-wildcard" x-show="npc.wc"></i></h1>

                        </article>
                    </div>    
                    <div class="pure-u-1-8">
                        <article class="parry" x-text="npc.parry">
                        </article>
                    </div>
                    <div class="pure-u-1-8">
                        <article class="ranged" x-text="npc.rangedMalus">
                        </article>
                    </div>      
                    <div class="pure-u-1-8">  
                        <article x-text="npc.toughness" class="toughness">
                        </article>
                    </div>    
                    <div class="pure-u-1">
                        <form>
                            <div>
                                <label x-bind:for="'shaken'+idx">Secou√©</label>
                                <input type="checkbox" x-bind:id="'shaken'+idx">
                            </div>
                            <div>
                                Blessures
                                <input type="radio" x-bind:name="'wound_level'+idx" x-bind:id="'wound_level_0_'+idx">
                                <label x-bind:for="'wound_level_0_'+idx">0</label>
                                <input type="radio" x-bind:name="'wound_level'+idx" x-bind:id="'wound_level_1_'+idx" x-show="npc.wc">
                                <label x-bind:for="'wound_level_1_'+idx" x-show="npc.wc">1</label>
                                <input type="radio" x-bind:name="'wound_level'+idx" x-bind:id="'wound_level_2_'+idx" x-show="npc.wc">
                                <label x-bind:for="'wound_level_2_'+idx" x-show="npc.wc">2</label>
                                <input type="radio" x-bind:name="'wound_level'+idx" x-bind:id="'wound_level_3_'+idx" x-show="npc.wc">
                                <label x-bind:for="'wound_level_3_'+idx" x-show="npc.wc">3</label>
                                <input type="radio" x-bind:name="'wound_level'+idx" x-bind:id="'wound_level_d_'+idx">
                                <label x-bind:for="'wound_level_d_'+idx"><i class="icon-heartbeat"></i></label>
                            </div>
                        </form> 
                    </div>
                </div>
            </template>
        </div>
        <script defer src="./alpine/cdn.min.js"></script>        
        <script>
            document.addEventListener('alpine:init', () => {
                Alpine.data('model', () => ({
                        encounter: [],
                        init() {
                            let param = new URLSearchParams(location.search)
                            let names = param.getAll('name')
                            for (let idx = 0; idx < names.length; idx++) {
                                let npc = {name: names[idx]}
                                npc.wc = param.getAll('w')[idx] == 'true'
                                npc.parry = param.getAll('p')[idx]
                                npc.rangedMalus = param.getAll('r')[idx]
                                npc.toughness = param.getAll('t')[idx]
                                npc.armor = param.getAll('a')[idx]
                                this.encounter.push(npc)
                            }
                        }
                    }))
            })
        </script>
    </body>
</html>
